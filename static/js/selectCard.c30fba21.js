(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["selectCard"],{"24d1":function(t,e,a){"use strict";var i=a("7af0"),s=a.n(i);s.a},"3ea7":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAADxElEQVRYR82Yf2gbZRjHv9+7ptUVZJhphYkoOP8Q9Z8qrqOapE6GIFMRpzhN7+YfazKHUCgM/CcO0aJoocTLBo6kBh1rRR2CsLXmsglTQe1f4o8pCloctA6nibXSu0cuNVnSNu1dctO8EMglz/N9Pnnufb/3viE8DnNE24h27gDlXhDXi/BaEpshWARkRoAZgN/bkJNW0ZrcMZQteilBt8G5Q/oDtPEMiF4AAZd5fwEwhfYrfQNjH7rJWRcoZ+ghUoYBbnUjWD9GJm2LB+55Ov3FWjp1gcbHH1E3ne8coXB/cyAXswWwCXk2EssM19NcFejM609dufC3fQzEdr9gqnVImRCruCeyb6KwXH8F0OlR/SqrTT4FecOlgClrCuTzy+aLd20bnJivga2+OHy4O7DFvnWK4N2XEuYiFI72xdK7AUj5s5oOmYaWAjnwX8BUzaxEJJZ5bgWQmdLCAE2vMF1btuLG3t1YXPgTX55IovDrT54kRGCrsnhLaF/2Kyex0qGcoX1C8k4valTa0LsnCbWtvZR24ZezmD7+oheJUixF3gnHMw9XgExDexDku16V2jdsxLboq5W0heJv+Dg76FXGmUJiW7zd8ahSh0xD/+hfB/Yk5h9QaVaP98XSj3IqGQ2qinoORJsnGgA+A52fCxaupmno/SAyXmGceD+BSvUXJeIAZUE80RJAkGHmU9opadAI/e4QIW8xZ2jfkLypXofKPhPo6GykiZWc+d9nXfiU5JlL6UUCG1arttxnmiJy4VMi8q3ToQskr1gdSEWvnoQa6GiWZck4z32H6fdeqKtVBmqtW9Zykzpv6GNCRBu5J36vMjjLPmdoj5N8syWAHGNslUcHgLnZYOGapYdrSjMBhr12yc9bRsEb4Xi6vwSUM/p3ksrx/w9IRIHaHYodma5s0MyUfgZAjxcoKrU+tZ7PrGFAxyLxzGOVDZrzZioZ7VFV1YHyNJrdwjpHcEWRm0MDmbM1QM5F/pD2kgiHPBE1GUxgMBxLj5Rlak4diQSUUJf+NoCHmqzjKl2AVF8sHa8OXnFQPPHyk52BTvUUyW5Xqg0HyeRssHjfrl0T1ppAzpcfjO7vuDzwxxGAziHO9yHAyFywMLQcZsUcWl7ZTGkHAD4PQPWJagGCvZF4eqye3rp/x5w2ordZVA8CshPguvGrFRKIRZGjisKD5dXUMFA5Mf+adocoiIvwfhKbXHbsZxH7faocjezNfO0mx/MvlkRCMbt+6CG4neB1AmzG0ssSyIwCzNiCH6lYJyMD2c/cQFTH/APz4KymnbiUAgAAAABJRU5ErkJggg=="},"5dcb":function(t,e,a){"use strict";var i=a("96d0"),s=a.n(i);s.a},"672b":function(t,e,a){"use strict";a.r(e);var i,s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mgb100"},[i("top-msg",{attrs:{"header-name":"选择银行卡"}}),i("div",{staticClass:"con_body"},[i("div",{staticClass:"channel-desc"},[i("div",[i("div",{staticClass:"channel-desc-head"},[t._v("当前通道：")]),i("div",{staticClass:"channel-desc-bottom"},[t._v("\n          "+t._s(t.channelName)+"\n        ")])]),i("div",[i("div",{staticClass:"channel-desc-head"},[t._v("手续费 (元) ：￥"+t._s((t.wrapTotalAmount-t.wrapPaybackAmount-t.computeFee).toFixed(2)))]),i("div",{staticClass:"channel-desc-bottom"},[t._v("\n          结算费 (元/笔) ：￥"+t._s(t.computeFee)+"\n        ")])])]),i("div",{staticClass:"tongdaobg"},[i("div",{staticClass:"flex-vertical-centering tongdao"},[i("div",{staticClass:"pay-money-title"},[t._v("付款金额 (元)")]),i("p",{staticClass:"colorfff"},[t._v("\n          "+t._s(t.wrapTotalAmount)+"\n        ")]),i("i",{staticClass:"iconfont icon-xia xia"}),i("div",{staticClass:"pay-money-title"},[t._v("实际到账金额 (元)")]),i("p",{staticClass:"colorfff"},[t._v("\n          "+t._s(t.wrapPaybackAmount)+"\n        ")])])]),i("div",{staticClass:"select_content"},[i("div",{staticClass:"select_make"},[t.chooseCity?i("div",{staticClass:"form_cellBd clear",on:{click:function(e){t.areaPicker=!0}}},[i("span",{staticClass:"select-city-label"},[t._v("选择交易城市")]),i("span",{staticClass:"color999 rt size30"},[t._v("\n            "+t._s(t.cityVal.name)+"\n            "),i("van-icon",{staticClass:"size24",attrs:{name:"arrow"}})],1)]):t._e(),t.industryList&&""!=t.industryList?i("div",{staticClass:"form_cellBd clear",on:{click:function(e){t.industryPicker=!0}}},[i("span",{staticClass:"select-industry-label"},[t._v("选择行业")]),i("span",{staticClass:"color999 rt size30"},[t._v("\n            "+t._s(t.industryName)+"\n            "),i("van-icon",{attrs:{name:"arrow"}})],1)]):t._e()]),i("div",{staticClass:"select_warp"},[i("div",{staticClass:"select_title flex_sb"},[i("div",{staticClass:"w100 flex-row-between"},[i("span",{staticClass:"select-card"},[t._v("请选择贷记卡")]),i("span",{staticClass:"size28 maincolor",on:{click:function(e){return t.gotoChangeCard("creditCard",t.creditCardMsg.id)}}},[t._v("更换")])])]),t.creditCardMsgAdd?i("div",{staticClass:"card_add"},[i("router-link",{staticClass:"btn2 flex-vertical-centering",attrs:{to:{path:"/addCreditCard",query:{status:"add"}}}},[i("div",{staticClass:"flex-row-center"},[i("img",{staticClass:"add-card-img",attrs:{src:a("3ea7")}}),i("span",{staticClass:"add-card-center-content"},[t._v("添加贷记卡")])])])],1):t._e(),i("div",{staticClass:"card_warp"},[t.creditCardMsgAdd?t._e():i("div",{staticClass:"select_card flex flex_alCen"},[i("div",{staticClass:"card_logo w25"},[t.creditCardMsg.bank_info.bank_logo_image?i("img",{attrs:{src:t.creditCardMsg.bank_info.bank_logo_image.url}}):t._e()]),t.creditCardMsg?i("div",{staticClass:"w75 lineheight70"},[i("h5",{staticClass:"colorfff size30"},[t._v("\n                "+t._s(t.creditCardMsg.bank_info.name)+"\n              ")]),i("p",{staticClass:"colorfff size36"},[t._v("\n                "+t._s("**** **** *** "+t.creditCardMsg.card_info.card_no.substr(t.creditCardMsg.card_info.card_no.length-4))+"\n              ")])]):t._e(),i("div",{staticClass:"z_check"},[i("p",[t._v("账单日："+t._s(t.creditCardMsg.card_info.bill_date)+"号")]),i("p",[t._v("还款日："+t._s(t.creditCardMsg.card_info.repayment_date)+"号")])])])])]),i("div",{staticClass:"select_warp"},[i("div",{staticClass:"select_title flex_sb"},[i("div",{staticClass:"w100 flex-row-between"},[i("span",{staticClass:"select-card"},[t._v("请选择借记卡")]),i("span",{staticClass:"size28 maincolor",on:{click:function(e){return t.gotoChangeCard("cashCard",t.debitCardMsg.id)}}},[t._v("更换")])])]),t.debitCardMsgAdd?i("div",{staticClass:"card_add"},[i("router-link",{staticClass:"btn2 flex-vertical-centering",attrs:{to:{path:"/addCard",query:{status:"add"}}}},[i("div",{staticClass:"flex-row-center"},[i("img",{staticClass:"add-card-img",attrs:{src:a("3ea7")}}),i("span",{staticClass:"add-card-center-content"},[t._v("添加借记卡")])])])],1):t._e(),i("div",{staticClass:"card_warp"},[t.debitCardMsgAdd?t._e():i("div",{staticClass:"select_card2 flex flex_alCen"},[i("div",{staticClass:"card_logo w25"},[t.debitCardMsg.bank_info.bank_logo_image?i("img",{attrs:{src:t.debitCardMsg.bank_info.bank_logo_image.url}}):t._e()]),t.debitCardMsg?i("div",{staticClass:"w75 lineheight70"},[i("h5",{staticClass:"colorfff size30"},[t._v("\n                "+t._s(t.debitCardMsg.bank_info.name)+"\n              ")]),i("p",{staticClass:"colorfff size36"},[t._v("\n                "+t._s("**** **** *** "+t.debitCardMsg.card_info.card_no.substr(t.debitCardMsg.card_info.card_no.length-4))+"\n              ")])]):t._e()])])])])]),t.isSubmit?t._e():i("div",{staticClass:"btn_warp",on:{click:t.payFun}},[t._v("\n    确定\n  ")]),t.isSubmit?i("div",{staticClass:"btn_warp"},[t._v("\n    已提交\n  ")]):t._e(),i("van-popup",{attrs:{position:"bottom"},model:{value:t.areaPicker,callback:function(e){t.areaPicker=e},expression:"areaPicker"}},[i("area-search-picker",{staticClass:"select_city",on:{selectArea:t.selectArea}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:t.industryPicker,callback:function(e){t.industryPicker=e},expression:"industryPicker"}},[i("van-picker",{attrs:{"show-toolbar":"",columns:t.industryList},on:{cancel:t.channelCodeCancel,confirm:t.channelCodeConfirm}})],1)],1)},n=[],r=a("2c92"),c=a("494e"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bgfff"},[a("div",[t._m(0),a("div",{staticClass:"search_warp"},[a("i",{staticClass:"icon_search"}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchValue,expression:"searchValue"}],staticClass:"search_input",attrs:{type:"text",placeholder:"请输入城市名称关键词"},domProps:{value:t.searchValue},on:{input:function(e){e.target.composing||(t.searchValue=e.target.value)}}})])]),a("div",{staticClass:"search_content selectcity"},[a("mt-index-list",{attrs:{height:456}},t._l(t.bankListArr,(function(e,i){return a("mt-index-section",{key:i,attrs:{index:i}},t._l(e,(function(e,i){return a("li",{key:i,staticClass:"search_item",on:{click:function(a){return t.clickCard(e)}}},[t._v("\n          "+t._s(e.name)+"\n        ")])})),0)})),1)],1)])},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search_title"},[a("h5",{staticClass:"size36 color333"},[t._v("\n        选择城市\n      ")])])}],l=a("76a0");a("8635"),a("f1a6");function u(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var C={name:"AreaSearchPicker",components:(i={},u(i,l["IndexList"].name,l["IndexList"]),u(i,l["IndexSection"].name,l["IndexSection"]),i),data:function(){return{bankListArr:{},searchValue:"",resultsList:""}},computed:{bankList:function(){return this.$store.state.bankList}},watch:{searchValue:function(t,e){var a=String(t).toUpperCase(),i=[];this.resultsList.forEach((function(t){-1===String(t.name).indexOf(a)&&-1===String(t.first_pinyin_letter).indexOf(a)||i.push(t)})),this.bankListArr=i.reduce((function(t,e){return t[e.first_pinyin_letter[0]]||(t[e.first_pinyin_letter[0]]=[]),t[e.first_pinyin_letter[0]].push(e),t}),{}),this.bankListArr=this.objKeySort(this.bankListArr)}},created:function(){this.getCityListFun()},methods:{thisTitle:function(){document.title="选择银行卡"},getCityListFun:function(){var t=this;t.$api.proceeds.getCityList().then((function(e){console.log(e),t.resultsList=e.data.data,t.bankListArr=t.resultsList.reduce((function(t,e){return console.log(t),t[e.first_pinyin_letter[0]]||(t[e.first_pinyin_letter[0]]=[]),t[e.first_pinyin_letter[0]].push(e),t}),{}),t.bankListArr=t.objKeySort(t.bankListArr)}))},objKeySort:function(t){for(var e=Object.keys(t).sort(),a={},i=0;i<e.length;i++)a[e[i]]=t[e[i]];return a},clickCard:function(t){this.$emit("selectArea",t)}}},h=C,g=(a("24d1"),a("731c"),a("2877")),f=Object(g["a"])(h,d,o,!1,null,"44d68a92",null),_=f.exports,p={name:"SelectCard",components:{topMsg:r["a"],AreaSearchPicker:_},data:function(){return{channelCode:this.$util.getQueryVariable("code"),totalAmount:100*this.$util.getQueryVariable("amount"),channelName:decodeURIComponent(this.$util.getQueryVariable("channelName")),debitCardMsg:"",debitCardMsgList:"",debitCardMsgAdd:!0,creditCardMsg:"",creditCardMsgList:"",creditCardMsgAdd:!0,isLoading:"",isSubmit:!1,areaList:"",cityVal:"",areaPicker:!1,industryList:[{text:"杭州",texts:"杭州"},{texts:"杭州",text:"宁波"},{texts:"杭州",text:"温州"}],industryPicker:!1,industryVal:"",industryName:"",chooseCity:!0}},computed:{currentDebitCard:function(){return this.$store.state.currentDebitCard},currentCreditCard:function(){return this.$store.state.currentCreditCard},computeRate:function(){return(100*this.settleMsg.rate).toFixed(2)},computeFee:function(){return(this.settleMsg.fee/100).toFixed(2)},settleMsg:function(){return this.$store.state.settleMsg},wrapTotalAmount:function(){return(this.settleMsg.total_amount/100).toFixed(2)},wrapPaybackAmount:function(){return(this.settleMsg.payback_amount/100).toFixed(2)},cityRecord:{get:function(){return JSON.parse(localStorage.getItem("selectCardArea"))},set:function(t){localStorage.setItem("selectCardArea",JSON.stringify(t))}}},watch:{creditCardMsg:{handler:function(t,e){},deep:!0}},created:function(){this.init(),this.thisTitle(),this.getIndustryListFun(),this.settleMsg||(this.isLoading=this.$toast("请重新下单"),this.$router.push("/proceeds")),this.currentDebitCard?(this.debitCardMsg=this.currentDebitCard,this.debitCardMsgAdd=!1):this.getCardListFun(),this.currentCreditCard?(this.creditCardMsg=this.currentCreditCard,this.creditCardMsgAdd=!1):this.getCreditCardListFun(),this.cityRecord&&(this.cityVal=this.cityRecord),this.chooseCity=this.$store.state.chooseCity},methods:{selectArea:function(t){this.cityVal=t,this.cityRecord=t,this.areaPicker=!1},channelCodeConfirm:function(t,e){var a=this;a.industryVal=a.industryList[e].channel_industry_id,a.industryName=t.name,this.industryPicker=!1},channelCodeCancel:function(){this.industryPicker=!1},channelCodeChange:function(t,e,a){var i=this;i.industryVal=i.industryList[a].channel_industry_id,i.industryName=e.name},onAddrConfirm:function(t){console.log(t),this.areaPicker=!1,this.cityVal=t[0].name+" "+t[1].name,console.log(this.cityVal)},onAddrCancel:function(){this.areaPicker=!1},init:function(){this.areaList=c["a"]},thisTitle:function(){document.title="选择银行卡"},gotoChangeCard:function(t,e){this.$router.push({path:"/changeCard",query:{type:t,id:e}})},getIndustryListFun:function(){var t=this;t.$api.proceeds.getIndustryList({channelCode:t.channelCode}).then((function(e){e.data.data.forEach((function(t,e){t.text=t.name})),t.industryList=e.data.data})).catch((function(t){console.log(t)}))},getCardListFun:function(){var t=this;t.$api.card.getCardList("DEBIT").then((function(e){console.log(e),t.debitCardMsgList=e.data.data,0!==t.debitCardMsgList.length?(t.debitCardMsgAdd=!1,t.debitCardMsg=t.debitCardMsgList[0],t.$store.commit("SET_CURRENT_DEBIT_CARD",t.debitCardMsg)):t.debitCardMsgAdd=!0}))},getCreditCardListFun:function(){var t=this;t.$api.card.getCardList("CREDIT").then((function(e){t.creditCardMsgList=e.data.data,0!==t.creditCardMsgList.length?(t.creditCardMsgAdd=!1,t.creditCardMsg=t.creditCardMsgList[0],t.$store.commit("SET_CURRENT_CREDIT_CARD",t.creditCardMsg)):t.creditCardMsgAdd=!0})).catch((function(t){console.log(t)}))},payFun:function(){var t=this,e=this,a=function(t){return e.$dialog({title:t,showCancelButton:!1,confirmButtonText:"确定",className:"dialog",closeOnClickOverlay:!0})};if(e.creditCardMsg.id)if(e.debitCardMsg.id)if(e.chooseCity&&!e.cityVal.code)a("请先选择交易城市！");else{var i={channel_code:e.channelCode,deposit_bank_id:e.creditCardMsg.id,payback_bank_id:e.debitCardMsg.id,total_amount:e.totalAmount,industry_id:e.industryVal,settlement_id:e.settleMsg.settlement_id};e.chooseCity&&(i.city_code=e.cityVal.code),e.$store.commit("SET_ORDER_DATA",i),e.$dialog({title:"确认即发起交易",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",className:"dialog",closeOnClickOverlay:!0}).then((function(){e.isLoading=t.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"请稍候..."}),e.payment()})).catch((function(){console.log("cancel")}))}else a("请先添加借记卡！");else a("请先添加贷记卡！")},judgeBindCard:function(){var t=this;if("NONE"===t.settleMsg.pay_provider_config.card_binding_type)return!1;if("INTERNAL_PAGE"===t.settleMsg.pay_provider_config.card_binding_type){if(t.demandChannelCardFun())return!1;t.$router.push({path:"/bindCard",query:{cardId:t.creditCardMsg.id,channelCode:t.channelCode}})}else if("EXTERNAL_URL"===t.settleMsg.pay_provider_config.card_binding_type)return!0},demandChannelCardFun:function(){var t=this;t.$api.card.demandChannelCard("CREDIT",t.creditCardMsg.id,t.channelCode).then((function(t){return!!t.data.data.has_succeeded})).catch((function(t){console.log(t)}))}}},m=p,v=(a("9cf5"),a("5dcb"),Object(g["a"])(m,s,n,!1,null,"c6c19f6c",null));e["default"]=v.exports},"731c":function(t,e,a){"use strict";var i=a("da6e"),s=a.n(i);s.a},"7af0":function(t,e,a){},"96d0":function(t,e,a){},"9cf5":function(t,e,a){"use strict";var i=a("b3c2"),s=a.n(i);s.a},b3c2:function(t,e,a){},da6e:function(t,e,a){}}]);