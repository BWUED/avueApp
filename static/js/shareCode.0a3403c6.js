(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shareCode"],{"2c92":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isWechat?e._e():s("div",{staticClass:"header"},[s("div",{staticClass:"header_body"},[s("span",{staticClass:"goBack",on:{click:e.goBack}},[s("van-icon",{attrs:{name:"arrow-left"}})],1),s("div",{staticClass:"flex-vertical-centering"},[s("p",{staticClass:"textEllipsis",on:{click:e.showLog}},[e._v("\n        "+e._s(e.headerName)+"\n      ")])]),e.shareShow?s("span",{staticClass:"shareSheet",on:{click:e.shareSheet}},[e._v("分享")]):e._e()])])},a=[],n={name:"TopMsg",props:{headerName:{type:String,default:""},required:{type:Boolean,default:!0},shareShow:{type:Boolean,default:!1}},data:function(){return{clickNum:0}},computed:{isWechat:function(){return this.$store.state.isWechat}},watch:{$route:function(){this.clickNum=0}},created:function(){},methods:{goBack:function(){var e=this;e.$router.go(-1)},shareSheet:function(){this.$emit("shareSheet")},showLog:function(){if(this.clickNum++,5===this.clickNum){this.clickNum=0;var e=document.getElementsByClassName("vc-switch")[0],t=window.getComputedStyle(e,null).getPropertyValue("display");"block"===t?VCONSOLE.hide():VCONSOLE.show()}}}},o=n,r=(s("9243"),s("2877")),c=Object(r["a"])(o,i,a,!1,null,"2cd8e979",null);t["a"]=c.exports},"589d":function(e,t,s){},"5e76":function(e,t,s){},8197:function(e,t,s){},"8c64":function(e,t,s){},9243:function(e,t,s){"use strict";var i=s("8c64"),a=s.n(i);a.a},9415:function(e,t,s){},"9b0f":function(e,t,s){s("a29f"),s("f251"),s("589d"),s("9415"),s("5e76")},cf28:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("top-msg",{attrs:{"header-name":"分享二维码","share-show":"true"},on:{shareSheet:function(t){return e.shareSheet()}}}),s("div",{staticClass:"con_body"},[s("div",{ref:"shareBox",staticClass:"share_codeImg"},[s("qrcode",{class:e.isWechat?"share_code":"share_code share_code2",attrs:{id:"qrcodeImg",value:e.codeValue,src:e.codeValue,options:{width:144},tag:"img"}}),s("img",{ref:"posterImg",attrs:{id:"backgroundImg",src:e.posterURL,crossOrigin:"anonymous"}})],1)]),s("van-actionsheet",{attrs:{actions:e.shareActions},on:{select:e.onShareSelect},model:{value:e.isShareSheet,callback:function(t){e.isShareSheet=t},expression:"isShareSheet"}})],1)},a=[],n=s("b2e5"),o=s.n(n),r=s("2c92"),c=s("c0e9"),h=s.n(c),u=(s("9b0f"),{name:"ShareCode",components:{topMsg:r["a"],Qrcode:o.a},data:function(){return{loading:!0,codeValue:"",shareURL:"",posterURL:"",isLoading:"",isTime:"",imgPreview:"",imgName:"",isShareSheet:!1,shareActions:[{key:"session",name:"朋友"},{key:"timeline",name:"朋友圈"}]}},computed:{userInfo:function(){return this.$store.state.userInfo},canvasRenderWidth:function(){return this.canvasWidth*this.rate},canvasRenderHeight:function(){return this.canvasHeight*this.rate},isWechat:function(){return this.$store.state.isWechat}},watch:{shareURL:function(e,t){}},created:function(){console.log("shareCode"),this.thisTitle(),this.codeValue="http://120.79.74.34:8080/h5/zhihuiren.html?referrer="+this.userInfo.username,console.log("分享图片 二维码: ",this.codeValue),this.posterURL=this.$route.params.poster+"?random="+Math.round(new Date/1e3),this.isLoading=this.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"图片正在生成中,请稍等..."})},mounted:function(){this.printQrcodePoster()},destroyed:function(){clearTimeout(this.isTime),this.$toast.clear()},methods:{shareSheet:function(){this.isShareSheet=!0},onShareSelect:function(e){var t=this,s=api.require("wx");s.shareImage({apiKey:"wx02df33802d384b32",scene:e.key,contentUrl:"fs://img/zhihuiren/"+t.imgName},(function(e,s){e.status?t.$toast({message:"分享成功",position:"middle",duration:2e3}):t.$toast({message:s.code,position:"middle",duration:2e3})})),this.isShareSheet=!1},thisTitle:function(){document.title="推荐码"},printQrcodePoster:function(){var e=this;setTimeout((function(){h()(e.$refs.shareBox,{scale:2,useCORS:!0}).then((function(t){var s=t.toDataURL("image/png");e.shareURL=s,e.imgName="shareCode_".concat((new Date).getTime(),".png");var i=api.require("trans");i.saveImage({base64Str:s.replace("data:image/png;base64,",""),album:!0,imgPath:"fs://img/zhihuiren",imgName:e.imgName},(function(t,s){e.isLoading.clear(),t.status?(e.isShareSheet=!0,e.$toast({message:"图片已保存, 分享给你的好友吧",position:"middle",duration:2e3})):e.$toast({message:"图片保存失败：".concat(s.msg),position:"middle",duration:2e3})}))}))}),1e3)}},beforeRouteLeave:function(e,t,s){this.imgPreview&&this.imgPreview.close(),clearTimeout(this.isTime),s()}}),d=u,l=(s("d4dc"),s("2877")),m=Object(l["a"])(d,i,a,!1,null,"2159e7e0",null);t["default"]=m.exports},d4dc:function(e,t,s){"use strict";var i=s("8197"),a=s.n(i);a.a}}]);